## Project Structure Update (May 2025)

**Current Status:**
- The pipeline for converting IFC to Neo4j is complete and robust, including domain-specific enrichment and full integration testing.
- The codebase is now ready for advanced querying, API development, and comprehensive documentation.
- The `examples/` directory demonstrates domain enrichment and graph capabilities.
- The `tests/` directory includes robust integration and end-to-end tests, ensuring reliability.

---

# IFC to Neo4j Knowledge Graph: Project Structure

This document provides a detailed overview of the project's file structure, explaining the purpose and organization of each directory and file.

## Root Directory (`ifc_knowledge_graph/`)

The `ifc_knowledge_graph` directory contains the following key components:

```
ifc_knowledge_graph/
├── .git/                  # Git repository data (not tracked in Git)
├── .gitignore             # Git ignore configuration
├── .pytest_cache/         # Pytest cache (not tracked in Git)
├── data/                  # Data storage and sample files
├── docs/                  # Documentation
├── examples/              # Example scripts and usage demonstrations (includes domain enrichment examples)
├── main.py                # Main application entry point
├── neo4j_setup_guide.md   # Guide for setting up Neo4j
├── output/                # Output files generated by the application
├── performance_reports/   # Performance reports
├── README.md              # Project overview and instructions
├── requirements.txt       # Python dependencies
├── src/                   # Source code
├── tests/                 # Test files (now includes robust integration tests)
├── topological_test.log   # Log file for topological tests
└── venv/                  # Virtual environment (not tracked in Git)
```

## Directory Details

### `data/`

The data directory stores IFC model files and other data used by the application.

```
data/
└── ifc_files/             # IFC model files
    └── Duplex_A_20110907.ifc # Sample IFC file (example, actual files may vary)
```

### `docs/`

The docs directory contains all project documentation.

```
docs/
├── concept.md             # Conceptual overview of the project
├── file_structure.md      # This document - explaining project structure
├── graph_quality_analysis.md # Documentation on graph quality analysis
├── implementation_plan.md # Implementation phases and tasks
├── parallel_processing.md # Documentation on parallel processing
├── schema_documentation.md # Database schema documentation
├── topological_testing.md # Documentation on topological testing
└── topologicpy.md         # Documentation related to TopologicPy
```

### `examples/`

This directory contains example scripts and notebooks demonstrating how to use the library and its features.

```
examples/
├── domain_enrichment_example.py  # Demonstrates domain-specific enrichment capabilities
└── ...                           # Other example scripts (to be added)
```

The `domain_enrichment_example.py` script shows how to use the domain enrichment functionality to:
- Classify building systems
- Extract and enhance material properties
- Extract performance properties
- Generate semantic tags
- Apply custom property mappings

The example can output enriched data to the console or store it directly in Neo4j.

### `output/`

This directory is used to store output files generated by the application, such as exported graphs or reports. (Contents to be detailed if available)

### `performance_reports/`

This directory contains reports related to the performance testing and analysis of the application. (Contents to be detailed if available)

### `src/`

The src directory contains all source code for the application, organized in a package structure.

```
src/
└── ifc_to_graph/          # Main package
    ├── __init__.py        # Package initialization
    ├── cli/               # Command-line interface
    │   ├── __init__.py    # CLI module initialization
    │   ├── ifc_parser_cli.py # Parser CLI
    │   └── ifc_to_neo4j_cli.py # Neo4j conversion CLI
    ├── database/          # Neo4j database operations
    │   ├── __init__.py    # Database module initialization
    │   ├── ifc_to_graph_mapper.py # IFC to graph mapping logic
    │   ├── neo4j_connector.py # Neo4j connection management
    │   ├── performance_monitor.py # Performance monitoring for database operations
    │   ├── schema.py      # Database schema definitions
    │   └── topologic_to_graph_mapper.py # Topologic to graph mapping logic
    ├── parser/            # IFC file parsing functionality
    │   ├── __init__.py    # Parser module initialization
    │   ├── domain_enrichment.py # Domain-specific enrichment for IFC data
    │   └── ifc_parser.py  # Core IFC parsing logic
    ├── processor.py       # Main processor for IFC to Neo4j conversion
    ├── topology/          # Topological analysis using TopologicPy
    │   ├── __init__.py    # Topology module initialization
    │   ├── README.md      # README for the topology module
    │   └── topologic_analyzer.py # Core TopologicPy analysis logic
    └── utils/             # Helper utilities
        ├── __init__.py    # Utils module initialization
        ├── graph_quality_analyzer.py # Utility for analyzing graph quality
        └── parallel_processor.py # Utility for parallel processing tasks
```

### `tests/`

The tests directory contains all tests for the application.

```
tests/
├── __init__.py            # Tests package initialization
├── test_check_nodes.py    # Tests for checking nodes
├── test_direct_connection.py # Test for direct Neo4j connection
├── test_graph_quality.py  # Tests for graph quality
├── test_ifc_parser.py     # Tests for IFC parser
├── test_neo4j_connection.py # Tests for Neo4j connection
├── test_neo4j_connector.py # Tests for Neo4j connector
├── test_neo4j_manual.py   # Manual tests for Neo4j
├── test_neo4j_topology.py # Tests for Neo4j topology integration
├── test_parallel.py       # Tests for parallel processing
├── test_parse.py          # Basic parsing tests
├── test_processor_manual.py # Manual tests for the processor
├── test_simple_parallel.py # Simple parallel processing tests
├── test_standalone_parallel.py # Standalone parallel processing tests
├── test_topological_features.py # Tests for topological features
└── test_topology.py       # Tests for topology module
```

## Module Purposes

### Source Code Modules

1.  **`src/ifc_to_graph/parser/`**:
    *   `ifc_parser.py`: Contains code for parsing IFC files using IfcOpenShell, extracting entities, properties, and relationships.
    *   `domain_enrichment.py`: Provides functionality for domain-specific enrichment of parsed IFC data.

2.  **`src/ifc_to_graph/topology/`**:
    *   `topologic_analyzer.py`: Contains code for analyzing topological relationships between building elements using TopologicPy, including adjacency, containment, and connectivity.

3.  **`src/ifc_to_graph/database/`**:
    *   `neo4j_connector.py`: Manages Neo4j connections, query execution, and transaction handling.
    *   `schema.py`: Defines the Neo4j database schema including node labels, relationship types, constraints, and indexes.
    *   `ifc_to_graph_mapper.py`: Contains logic for mapping IFC entities to Neo4j graph elements.
    *   `topologic_to_graph_mapper.py`: Contains logic for mapping TopologicPy elements and relationships to the Neo4j graph.
    *   `performance_monitor.py`: Monitors and logs performance metrics for database operations.

4.  **`src/ifc_to_graph/utils/`**:
    *   `parallel_processor.py`: Provides utilities for parallelizing processing tasks.
    *   `graph_quality_analyzer.py`: Contains tools for analyzing the quality and consistency of the generated graph.

5.  **`src/ifc_to_graph/cli/`**:
    *   `ifc_parser_cli.py`: Command-line interface for the IFC parser.
    *   `ifc_to_neo4j_cli.py`: Command-line interface for the IFC to Neo4j conversion process.

6.  **`src/ifc_to_graph/processor.py`**: Coordinates the entire IFC to Neo4j conversion process, utilizing the parser, topology, and database modules.

### Test and Utility Files (Root Level)

1.  **`main.py`**: Main entry point for the application, providing a command-line interface.
2.  **`neo4j_setup_guide.md`**: Provides step-by-step instructions for setting up the Neo4j database.
3.  **`topological_test.log`**: Log file generated during topological tests.

## Documentation Files

(Refer to the `docs/` section above for a list of documentation files.)

## Configuration Files

1.  **`.gitignore`**: Specifies files and directories that Git should ignore.
2.  **`requirements.txt`**: Lists all Python package dependencies for the project.

## Development Workflow

The project is structured to support the following development workflow:

1.  **Setup**: Follow the `neo4j_setup_guide.md` to prepare the database environment.
2.  **Data Preparation**: Place IFC model files in the `ifc_knowledge_graph/data/ifc_files/` directory.
3.  **Model Parsing**: Use the `parser` module (`src/ifc_to_graph/parser/`) to extract information from IFC files.
4.  **Topological Analysis**: Use the `topology` module (`src/ifc_to_graph/topology/`) to analyze spatial relationships.
5.  **Database Storage**: Use the `database` module (`src/ifc_to_graph/database/`) to store the extracted information in Neo4j.
6.  **Query and Analysis**: Use Neo4j queries (Cypher) to analyze and visualize the building information.

## Future Structure Additions

(This section can be updated as the project evolves further. The `examples/`, `output/`, and `performance_reports/` directories have been added based on the current structure.)

1.  **`scripts/`**: Directory for utility scripts for data processing, database setup, etc.
2.  **`docs/api/`**: API documentation generated from source code.
3.  **`docs/tutorials/`**: Step-by-step tutorials for using the library.
4.  **`migrations/`**: Database schema migration scripts.
